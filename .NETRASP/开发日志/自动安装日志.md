# 自动安装日志

## 安装命令

\$Env:ASPNETCORE_HOSTINGSTARTUPASSEMBLIES = IastNetAgent

- `\$Env:ASPNETCORE_HOSTINGSTARTUPASSEMBLIES = "{pluginName}"`
- `dotnet add package MonoMod.Common --version 20.5.31.1`
- `dotnet add package Lib.Harmony --version 2.0.2`
- `dotnet add package Newtonsoft.Json --version 12.0.3`
- [Mono 依赖问题](https://github.com/pardeike/Harmony/pull/263)

## 启动时指定 ip 及端口

`dotnet {fileName.dll} --server.urls "http://*:5001"`

## 使用 Nuget 打包类库

- [创建本地 nuget 包](https://docs.microsoft.com/zh-cn/nuget/create-packages/creating-localized-packages)
- [发布类库包](https://www.cnblogs.com/daxnet/archive/2013/05/07/3064577.html)

优点：

- 易于安装且稳定
- 自动处理依赖
- 更新方便

缺点：

- 将类库托管到 nuget 平台上

## 运行时存储

    > 无需编译时引用

- 使用清单项目文件和`dotnet store`命令生成运行时存储。

### 通过`additionalDeps`指定附加依赖项

- 附加依赖文件`.deps.json`
- 使承载启动程序集可被发现并加载

生成附加依赖文件的推荐方法：

1. 对运行时存储清单文件执行`dotnet publish`
2. 生成`deps.json`文件的`runtime`部分

### 部署

- 承载启动运行时存储
- 承载启动依赖项文件
- power shell 脚本：用于创建或修改环境变量以支持激活承载启动

### 激活

1. power shell
2. 执行`RuntimeStore\build.ps1`脚本
3. 运行`deployment\deploy.ps1`脚本

### stroe

[MSB3094 解决方案](https://ask.csdn.net/questions/1053228)
[Net Agent](https://www.cnblogs.com/kingreatwill/p/9756222.html#/cnblog/works/article/9756222)
[插件式安装](http://aizhengli.com/webapi-chajianfangan/276/WebApi%20%E6%8F%92%E4%BB%B6%E5%BC%8F%E6%9E%84%E5%BB%BA%E6%96%B9%E6%A1%88.html)
